---
title: 图像增强—自适应直方图均衡化（AHE）-限制对比度自适应直方图均衡（CLAHE）
date: 2019-09-21 21:44:45
tags: [图像处理, 图像增强]
---

图像增强—自适应直方图均衡化（AHE）-限制对比度自适应直方图均衡（CLAHE）
<!--more-->


### 一、自适应直方图均衡化(Adaptive histgram equalization/AHE)
#### 1.简述
自适应直方图均衡化(AHE)用来提升图像的对比度的一种计算机图像处理技术。和普通的直方图均衡算法不同，AHE算法通过计算图像的局部直方图，然后重新分布亮度来来改变图像对比度。因此，该算法更适合于改进图像的局部对比度以及获得更多的图像细节。
不过，AHE有过度放大图像中相同区域的噪音的问题，另外一种自适应的直方图均衡算法即限制对比度直方图均衡（CLAHE）算法能有限的限制这种不利的放大。
#### 2. 普通直方图均衡算法与AHE算法的解释
普通的直方图均衡算法对于整幅图像的像素使用相同的直方图变换，对于那些像素值分布比较均衡的图像效果比较好。然后，如果图像中包括明显比图像其它区域暗或者亮的部分，在这些部分的对比度将得不到有效的增强。

AHE算法通过对局部区域执行响应的直方图均衡来改变上述问题。该算法首先被开发出来适用于改进航天器驾驶舱的显示效果。其最简单的形式，就是每个像素通过其周边一个矩形范围内的像素的直方图进行均衡化。均衡的方式则完全同普通的均衡化算法：变换函数同像素周边的累积直方图函数（CDF）成比例。

图像边缘的像素需要特殊处理，因为边缘像素的领域不完全在图像内部。这个通过镜像图像边缘的行像素或列像素来解决。直接复制边缘的像素进行扩充是不合适的。因为这会导致带有剑锋的领域直方图。
#### 3. AHE算法的缺点
算法设定的邻域参数小，对比度得到增强，邻域参数大，则对比度会降低。

当某个区域包含的像素值非常接近，其区域的直方图就会尖状化，此时直方图的变换函数会将一个很窄范围内的像素映射到整个像素范围。这将使得某些平坦区域中的少量噪音经AHE处理后过度放大。
### 二、限制对比度自适应直方图均衡（Contrast Limited Adaptive histgram equalization/CLAHE)
#### 1.简述
CLAHE同普通的自适应直方图均衡不同的地方主要是其对比度限幅。这个特性也可以应用到全局直方图均衡化中，即构成所谓的限制对比度直方图均衡（CLHE），但这在实际中很少使用。在CLAHE中，对于每个小区域都必须使用对比度限幅。CLAHE主要是用来克服AHE的过度放大噪音的问题。

这主要是通过限制AHE算法的对比提高程度来达到的。在指定的像素值周边的对比度放大主要是由变换函数的斜度决定的。这个斜度和领域的累积直方图的斜度成比例。CLAHE通过在计算CDF前用预先定义的阈值来裁剪直方图以达到限制放大幅度的目的。这限制了CDF的斜度因此，也限制了变换函数的斜度。直方图被裁剪的值，也就是所谓的裁剪限幅，取决于直方图的分布因此也取决于领域大小的取值。
通常，直接忽略掉那些超出直方图裁剪限幅的部分是不好的，而应该将这些裁剪掉的部分均匀的分布到直方图的其他部分。如下图所示。
这个重分布的过程可能会导致那些倍裁剪掉的部分由重新超过了裁剪值（如上图的绿色部分所示）。如果这不是所希望的，可以不带使用重复不的过程指导这个超出的部分已经变得微不足道了。
#### 2. 通过插值加快计算速度
如上所述的直接的自适应直方图，不管是否带有对比度限制，都需要对图像中的每个像素计算器领域直方图以及对应的变换函数，这使得算法及其耗时。

而插值使得上述算法效率上有极大的提升，并且质量上没有下降。首先，将图像均匀分成等份矩形大小，如下图的右侧部分所示（8行8列64个块是常用的选择）。然后计算个块的直方图、CDF以及对应的变换函数。这个变换函数对于块的中心像素（下图左侧部分的黑色小方块）是完全符合原始定义的。而其他的像素通过哪些于其临近的四个块的变换函数插值获取。位于图中蓝色阴影部分的像素采用双线性查插值，而位于便于边缘的（绿色阴影）部分采用线性插值，角点处（红色阴影处）直接使用块所在的变换函数。

这样的过程极大的降低了变换函数需要计算的次数，只是增加了一些双线性插值的计算量。



### 效果对比

测试图像，见下图：
![](https://img-blog.nos-eastchina1.126.net/PersonalPhoto/SpaceMan.jpg)

直方图均衡化图像(HE)，见下图：
![HE](https://img-blog.nos-eastchina1.126.net/PersonalPhoto/SpaceMan-HE.jpg)

自适应直方图均衡化参数1（AHE），见下图：
![AHE](https://img-blog.nos-eastchina1.126.net/PersonalPhoto/SpaceMan-AHE4256.jpg)
自适应直方图均衡化参数2（AHE），见下图：
![AHE](https://img-blog.nos-eastchina1.126.net/PersonalPhoto/SpaceMan-AHE16256.jpg)


限制对比度自适应直方图均衡（CLAHE），见下图：
![](https://img-blog.nos-eastchina1.126.net/PersonalPhoto/SpaceMan-CLAHE.jpg)

从效果上来看，CLAHE算法效果比较好，提亮了暗处，高亮处不至于过曝；AHE算法需要添加参数，参数不同，影响增强效果不同，并且影响很大；HE算法全局提亮，整体略亮。

感兴趣的同学可以到我的github下载这些代码运行看看，链接如下：
[Matlab代码链接](https://github.com/AomanHao/Matlab-Image-Dehazing-Enhazing)

---

[参考文章](https://www.cnblogs.com/Imageshop/archive/2013/04/07/3006334.html)
[参考文章](https://blog.csdn.net/baimafujinji/article/details/50660189)
[参考文章](https://blog.csdn.net/kl1411/article/details/89100740)
[参考文章](https://blog.csdn.net/gdymind/article/details/82357139)




---

### [我的个人博客主页，欢迎访问](http://www.aomanhao.top/)
### [我的CSDN主页，欢迎访问](https://blog.csdn.net/Aoman_Hao)
### [我的GitHub主页，欢迎访问](https://github.com/AomanHao)


