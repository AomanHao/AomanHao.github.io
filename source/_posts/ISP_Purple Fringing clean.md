---
title: ISP图像处理——紫边Purple Fringing
date: 2021-02-01 10:08:00
tags: [ISP, 图像处理]
---

ISP图像处理——紫边Purple Fringing
<!--more-->
之前写过文章记紫边的形成原因，以下小结改善方法

图像紫边存在数码相机、监控摄像头等数字成像图像，使用设备在逆光、大光圈条件下拍摄图像的高反差区域容易出现紫边，解决图像自编问题有助设备得到完美图像。

紫边成因分析和确定有助与紫边消除的图像处理算法研究和摄像设备工程改进，能够改善自编的硬件成本更高，非常需要研究去除紫边的图像处理算法。

## 紫边
通过取色器中对“紫边”的色彩分析，可以发现，大部分紫边的主要构成就是洋红，这些紫边是由于高反差大背光静物边缘，产生光学衍射，加上DC/DV的CCD在色彩插值导致。

因为人对红、绿、蓝三种颜色的中绿分量比较敏感，大多sensor的bayer排列大多采样绿分量比较多，例如RGGB排列。
绿色采样结果比较多,相比红色和蓝色通道来说不容易发生混叠，而红蓝分量组合后表现为洋红色，与取色器的表现接近。


## 硬件改善紫边（镜头、sensor）
尽量选择低色差的镜头，验证色差曲线。sensor选择像元面积较大，保证光入射角度较大，亦可以规避shading问题。

### 算法改善

#### 在RGB域检测紫边

1、高亮区域检测

首先对R、G、B分别设置固定的亮度阈值，把图像分为很多块，精确一点可以选择`5*5`大小的邻域，粗糙一点可以选`13*13`，判断邻域内每一个像素点的R、G、B值是否超过R、G、B初设亮度阈值（可能不同），邻域内超过R、G、B初设亮度阈值的像素记录数目分别为RNum、GNum、BNum，，当RNum、GNum、BNum同时满足＞设定的高亮区域像素数阈值（R、G、B三通道可能不同）时，判定该区域为高亮区域。

2、边缘区域检测

既可以使用常用的边缘检测算子Roberts 梯度算子、拉普拉斯梯度算子等，也可以分析像素区域方差趋势来判断是否属于边缘。统计区域内像素方差，判断方差值与初设方差阈值的大小，只有大于该阈值的区域才被认为是边缘。

>像素方差阈值判断方法需要基于降噪后的图像进行处理，算法简单易于实现，但运算速度较传统的
边缘检测算法慢

满足以上高亮和边缘区域多个条件的像素可以认为是紫边。

#### 矫正紫边
紫边区域紫色饱和度淡化，具体措施不晓得，再看看文献好了



### [我的个人博客主页，欢迎访问](http://www.aomanhao.top/)
### [我的CSDN主页，欢迎访问](https://blog.csdn.net/Aoman_Hao)
### [我的GitHub主页，欢迎访问](https://github.com/AomanHao)


